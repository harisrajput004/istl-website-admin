<div class="my-[30px] flex flex-col gap-[24px] overflow-x-auto w-full font_inter">

    <div class="my-[30px] flex flex-col gap-[24px] overflow-x-auto w-full font_inter overflow-y-auto max-h-[465px]">
        <form (ngSubmit)="onSubmit()" [formGroup]="jobForm" class="flex flex-col gap-4">

            <div class="py-[35px] px-[30px] rounded-[15px] bg-[#F2F2F2]">
                <div class="flex flex-col gap-[20px]">
                    <h3 class="text-[#333] font-medium">Edit Job</h3>

                    <div class="flex flex-col gap-[20px]">

                        <div class="flex flex-col gap-[15px]">
                            <label class="text-[#333] font-medium" for="title">Title</label>
                            <input id="title" formControlName="title" type="text" placeholder="Title"
                                class="px-[20px] py-[8px] rounded-[5px] bg-[#F6F6F6] shadow-[0px_0px_3px_0px_rgba(66,156,214,0.38)] text-[#292929] font-normal" />
                            <div *ngIf="jobForm.get('title')?.invalid && jobForm.get('title')?.touched"
                                class="text-red-500 text-sm">
                                Title is required
                            </div>
                        </div>

                        <div class="flex flex-col gap-[15px]">
                            <label class="text-[#333] font-medium" for="currency">Currency</label>
                            <select id="currency" formControlName="currency"
                                class="px-[20px] py-[8px] rounded-[5px] bg-[#F6F6F6] shadow-[0px_0px_3px_0px_rgba(66,156,214,0.38)] text-[#292929] font-normal">
                                <option value="" disabled>Select a currency</option>
                                <option *ngFor="let currency of currencies"
                                    [value]="currency.code + ' ' + currency.symbol"
                                    [selected]="isCurrencySelected(currency)">
                                    {{ currency.name }} ({{ currency.symbol }})
                                </option>
                            </select>
                            <div *ngIf="jobForm.get('currency')?.invalid && jobForm.get('currency')?.touched"
                                class="text-red-500 text-sm">
                                Currency is required
                            </div>
                        </div>

                        <div class="flex flex-col gap-[15px]">
                            <label class="text-[#333] font-medium" for="minSalary">Min Salary</label>
                            <input id="minSalary" formControlName="minSalary" type="number" placeholder="Min Salary"
                                class="px-[20px] py-[8px] rounded-[5px] bg-[#F6F6F6] shadow-[0px_0px_3px_0px_rgba(66,156,214,0.38)] text-[#292929] font-normal" />
                            <div *ngIf="jobForm.get('minSalary')?.invalid && jobForm.get('minSalary')?.touched"
                                class="text-red-500 text-sm">
                                <span *ngIf="jobForm.get('minSalary')?.errors?.['required']">Min Salary is
                                    required</span>
                                <span *ngIf="jobForm.get('minSalary')?.errors?.['min']">Must be 0 or greater</span>
                            </div>
                        </div>

                        <div class="flex flex-col gap-[15px]">
                            <label class="text-[#333] font-medium" for="maxSalary">Max Salary</label>
                            <input id="maxSalary" formControlName="maxSalary" type="number" placeholder="Max Salary"
                                class="px-[20px] py-[8px] rounded-[5px] bg-[#F6F6F6] shadow-[0px_0px_3px_0px_rgba(66,156,214,0.38)] text-[#292929] font-normal" />
                            <div *ngIf="jobForm.get('maxSalary')?.invalid && jobForm.get('maxSalary')?.touched"
                                class="text-red-500 text-sm">
                                <span *ngIf="jobForm.get('maxSalary')?.errors?.['required']">Max Salary is
                                    required</span>
                                <span *ngIf="jobForm.get('maxSalary')?.errors?.['min']">Must be 0 or greater</span>
                            </div>
                        </div>

                        <div class="flex flex-col gap-[15px]">
                            <label class="text-[#333] font-medium" for="jobStatusId">Job Status</label>
                            <select id="jobStatusId" formControlName="jobStatusId"
                                class="px-[20px] py-[8px] rounded-[5px] bg-[#F6F6F6] shadow-[0px_0px_3px_0px_rgba(66,156,214,0.38)] text-[#292929] font-normal">
                                <option [ngValue]="null" disabled>Select Job Status</option>
                                <option *ngFor="let status of jobStatusOptions" [value]="status.id">
                                    {{ status.name }}
                                </option>
                            </select>
                            <div *ngIf="jobForm.get('jobStatusId')?.invalid && jobForm.get('jobStatusId')?.touched"
                                class="text-red-500 text-sm">
                                Job Status is required
                            </div>
                        </div>

                        <div class="flex flex-col gap-[15px]">
                            <label class="text-[#333] font-medium" for="experienceYearsRequired">Experience
                                (Years)</label>
                            <input id="experienceYearsRequired" formControlName="experienceYearsRequired" type="number"
                                placeholder="Experience (Years)"
                                class="px-[20px] py-[8px] rounded-[5px] bg-[#F6F6F6] shadow-[0px_0px_3px_0px_rgba(66,156,214,0.38)] text-[#292929] font-normal" />
                            <div *ngIf="jobForm.get('experienceYearsRequired')?.invalid && jobForm.get('experienceYearsRequired')?.touched"
                                class="text-red-500 text-sm">
                                Experience is required
                            </div>
                        </div>

                        <div class="flex flex-col gap-[15px]">
                            <label class="text-[#333] font-medium" for="vacancies">Vacancies</label>
                            <input id="vacancies" formControlName="vacancies" type="number" placeholder="Vacancies"
                                class="px-[20px] py-[8px] rounded-[5px] bg-[#F6F6F6] shadow-[0px_0px_3px_0px_rgba(66,156,214,0.38)] text-[#292929] font-normal" />
                            <div *ngIf="jobForm.get('vacancies')?.invalid && jobForm.get('vacancies')?.touched"
                                class="text-red-500 text-sm">
                                Vacancies is required
                            </div>
                        </div>

                        <div class="flex flex-col gap-[15px]">
                            <label class="text-[#333] font-medium" for="expiresOn">Expires On</label>
                            <input id="expiresOn" formControlName="expiresOn" type="date" placeholder="Expires On"
                                class="px-[20px] py-[8px] rounded-[5px] bg-[#F6F6F6] shadow-[0px_0px_3px_0px_rgba(66,156,214,0.38)] text-[#292929] font-normal" />
                            <div *ngIf="jobForm.get('expiresOn')?.invalid && jobForm.get('expiresOn')?.touched"
                                class="text-red-500 text-sm">
                                Expiration date is required
                            </div>
                        </div>

                        <div class="grid grid-cols-3 gap-[18px]">
                            <div class="flex flex-col gap-[8px]">
                                <label class="font_14px text-[#18191C] font-normal">Job Tags</label>
                                <div class="relative">
                                    <div id="dropdownTrigger" (click)="toggleDropdown()"
                                        class="flex flex-wrap gap-2 p-2 border border-[#A7A7A7] rounded-[5px] bg-[#FFF] min-h-[44px] cursor-pointer">
                                        <span *ngIf="selectedTags.length === 0" class="text-gray-400">Select tag</span>
                                        <div *ngFor="let tagId of getUniqueSelectedTags()"
                                            class="bg-gray-200 px-2 py-1 rounded-full text-sm flex items-center">
                                            {{ getTagName(tagId) }}
                                            <button type="button" (click)="removeTag(tagId, $event)"
                                                class="ml-1 text-red-500">Ã—</button>
                                        </div>
                                        <div class="ml-auto text-gray-500">
                                            <svg [ngClass]="{ 'rotate-180': isDropdownOpen }"
                                                class="w-4 h-4 transition-transform duration-200" fill="none"
                                                stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"
                                                stroke-linecap="round" stroke-linejoin="round">
                                                <path d="M6 9l6 6 6-6"></path>
                                            </svg>
                                        </div>
                                    </div>

                                    <div *ngIf="isDropdownOpen" id="dropdown"
                                        class="absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-auto">
                                        <div *ngFor="let tag of tags"
                                            class="px-4 py-2 hover:bg-gray-100 cursor-pointer flex items-center"
                                            (click)="onTagSelect(tag.id)">
                                            <input type="checkbox" [id]="'tag-' + tag.id"
                                                [checked]="selectedTags.includes(tag.id)"
                                                (change)="onTagSelect(tag.id, $event)" class="mr-2">
                                            <label [for]="'tag-' + tag.id" class="cursor-pointer flex-1">{{ tag.tagName
                                                }}</label>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="flex flex-col gap-[8px] col-span-1">
                                <label class="font_14px text-[#18191C] font-normal">Job Categories</label>
                                <select formControlName="jobCategoryId"
                                    class="w-full text-[#9199A3] text-[16px] font-normal px-[18px] py-[12px] rounded-[5px] border border-[#A7A7A7] bg-[#FFF]">
                                    <option [value]="null">Select a category</option>
                                    <option *ngFor="let category of categories" [value]="category.id">
                                        {{ category.jobCategoryName }}
                                    </option>
                                </select>
                                <div *ngIf="jobForm.get('jobCategoryId')?.invalid && jobForm.get('jobCategoryId')?.touched"
                                    class="text-red-500 text-sm">
                                    Category is required
                                </div>
                            </div>
                        </div>

                        <div class="flex flex-col gap-[15px]">
                            <label class="text-[#333] font-medium" for="description">Description</label>
                            <textarea id="description" formControlName="description" placeholder="Description"
                                class="px-[20px] py-[8px] h-[120px] rounded-[5px] bg-[#F6F6F6] shadow-[0px_0px_3px_0px_rgba(66,156,214,0.38)] text-[#292929] font-normal"></textarea>

                            <div *ngIf="jobForm.get('description')?.invalid && jobForm.get('description')?.touched"
                                class="text-red-500 text-sm">
                                Description is required
                            </div>
                        </div>

                        <div class="flex flex-col gap-[15px]">
                            <label class="text-[#333] font-medium" for="responsibilities">Responsibilities</label>
                            <textarea id="responsibilities" formControlName="responsibilities"
                                placeholder="Responsibilities"
                                class="px-[20px] py-[8px] h-[120px] rounded-[5px] bg-[#F6F6F6] shadow-[0px_0px_3px_0px_rgba(66,156,214,0.38)] text-[#292929] font-normal"></textarea>
                            <div *ngIf="jobForm.get('responsibilities')?.invalid && jobForm.get('responsibilities')?.touched"
                                class="text-red-500 text-sm">
                                Responsibilities is required
                            </div>
                        </div>

                        <div class="flex flex-col gap-[15px]">
                            <label class="text-[#333] font-medium" for="city">City</label>
                            <input id="city" formControlName="city" type="text" placeholder="City"
                                class="px-[20px] py-[8px] rounded-[5px] bg-[#F6F6F6] shadow-[0px_0px_3px_0px_rgba(66,156,214,0.38)] text-[#292929] font-normal" />
                            <div *ngIf="jobForm.get('city')?.invalid && jobForm.get('city')?.touched"
                                class="text-red-500 text-sm">
                                City is required
                            </div>
                        </div>

                        <div class="flex flex-col gap-[15px]">
                            <label class="text-[#333] font-medium" for="country">Country</label>
                            <input id="country" formControlName="country" type="text" placeholder="Country"
                                class="px-[20px] py-[8px] rounded-[5px] bg-[#F6F6F6] shadow-[0px_0px_3px_0px_rgba(66,156,214,0.38)] text-[#292929] font-normal" />
                            <div *ngIf="jobForm.get('country')?.invalid && jobForm.get('country')?.touched"
                                class="text-red-500 text-sm">
                                Country is required
                            </div>
                        </div>

                        <div class="flex justify-end gap-[10px] w-full pt-[10px]">
                            <button type="submit" class="primary_button cursor-pointer" [disabled]="isSubmitting">
                                <span *ngIf="!isSubmitting">Save</span>
                                <span *ngIf="isSubmitting">Saving...</span>
                            </button>
                            <a routerLink="/jobs" class="transarent_button">Cancel</a>
                        </div>

                    </div>
                </div>
            </div>

        </form>
    </div>
</div>